(function(t){function e(e){for(var n,a,o=e[0],h=e[1],c=e[2],u=0,d=[];u<o.length;u++)a=o[u],Object.prototype.hasOwnProperty.call(s,a)&&s[a]&&d.push(s[a][0]),s[a]=0;for(n in h)Object.prototype.hasOwnProperty.call(h,n)&&(t[n]=h[n]);l&&l(e);while(d.length)d.shift()();return r.push.apply(r,c||[]),i()}function i(){for(var t,e=0;e<r.length;e++){for(var i=r[e],n=!0,o=1;o<i.length;o++){var h=i[o];0!==s[h]&&(n=!1)}n&&(r.splice(e--,1),t=a(a.s=i[0]))}return t}var n={},s={app:0},r=[];function a(e){if(n[e])return n[e].exports;var i=n[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,a),i.l=!0,i.exports}a.m=t,a.c=n,a.d=function(t,e,i){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(a.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)a.d(i,n,function(e){return t[e]}.bind(null,n));return i},a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="/elgamal/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],h=o.push.bind(o);o.push=e,o=o.slice();for(var c=0;c<o.length;c++)e(o[c]);var l=h;r.push([1,"chunk-vendors"]),i()})({0:function(t,e){},1:function(t,e,i){t.exports=i("56d7")},"56d7":function(t,e,i){"use strict";i.r(e);i("e260"),i("e6cf"),i("cca6"),i("a79d");var n=i("2b0e"),s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("Main")],1)},r=[],a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"wrapper"},[i("h1",[t._v("ELGAMAL Signature Algorithm")]),i("div",{staticClass:"main"},[i("div",{staticClass:"left"},[i("h2",[t._v("Отправитель")]),i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.m,expression:"m"}],staticClass:"text",attrs:{cols:"30",rows:"10"},domProps:{value:t.m},on:{input:function(e){e.target.composing||(t.m=e.target.value)}}}),i("br"),t._v(" Открытый ключ: "),i("div",[t._v("p: "+t._s(t.p))]),i("div",[t._v("g: "+t._s(t.g))]),i("div",[t._v("y: "+t._s(t.y))]),i("br"),t._v(" Закрытый ключ: "),i("div",[t._v("x: "+t._s(t.x))]),i("br"),t._v(" Дайджест: "),i("div",[t._v(t._s(t.hash))]),i("br"),t._v(" Сессионный ключ: "),i("div",[t._v("k: "+t._s(t.k))]),i("br"),t._v(" Шифротекст: "),i("ol",{attrs:{type:"A"}},[i("li",[t._v(t._s(t.A))]),i("li",[t._v(t._s(t.B))])])]),i("div",{staticClass:"right"},[i("h2",[t._v("Получатель")]),i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.send,expression:"send"}],staticClass:"text",attrs:{cols:"30",rows:"10"},domProps:{value:t.send},on:{input:function(e){e.target.composing||(t.send=e.target.value)}}}),i("br"),i("div",[t._v("Вычисляемые значения")]),i("hr",{attrs:{width:"100%"}}),i("table",{attrs:{cellspacing:"0"}},[i("tr",[i("td",[t._v("Дайджест")]),i("td",[t._v(t._s(t.hash1))])]),i("tr",[t._m(0),i("td",[t._v(t._s(t.checked))])]),i("tr",[t._m(1),i("td",[t._v(t._s(t.checked))])]),i("tr",[i("td",{class:{green:t.checked,red:!t.checked},attrs:{colspan:"2"}},[t.checked?i("div",[t._v("Verified signature")]):i("div",[t._v("Invalid signature")])])])]),i("br"),i("br"),i("div",[t._v("Получаемые значения")]),i("hr",{attrs:{width:"100%"}}),t._v(" Открытый ключ: "),i("div",[t._v("p: "+t._s(t.p))]),i("div",[t._v("g: "+t._s(t.g))]),i("div",[t._v("y: "+t._s(t.y))]),i("br"),t._v(" Шифротекст: "),i("div",[i("ol",{attrs:{type:"A"}},[i("li",[t._v(t._s(t.A))]),i("li",[t._v(t._s(t.B))])])])])])])},o=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("td",[t._v("y"),i("sup",[t._v("A")]),t._v(" * A"),i("sup",[t._v("B")]),t._v(" (mod p)")])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("td",[t._v("g"),i("sup",[t._v("hash")]),t._v(" (mod p)")])}],h=(i("d3b7"),i("25f0"),i("5c1a")),c=i.n(h),l=i("7409");String.prototype.hashCode=function(){var t=0;if(0==this.length)return t;for(var e=0;e<this.length;e++){var i=this.charCodeAt(e);t=(t<<5)-t+i,t&=t}return t};var u={name:"Main",data:function(){return{m:null,send:null,prime:null,p:null,g:null,x:null,y:null,k:null,A:null,B:null,salt:null,hash:null,hash1:null,bits:24,checked:0}},watch:{m:function(t){this.send=this.m,this.sign()},send:function(t){this.check()}},mounted:function(){this.m="Secret message",this.start()},methods:{start:function(){var t=this;c.a.prime.generateProbablePrime(this.bits,(function(e,i){t.prime=i.toString(10),t.p=l(t.prime)})),this.g=l(this.getRandomInt(this.prime)),this.x=l(this.getRandomInt(this.prime-1)),this.y=this.g.modPow(this.x,this.p)},getRandomInt:function(t){return BigInt(Math.floor(Math.random()*t).toString())},sign:function(){var t=this;if(this.m){var e=l(this.send.hashCode());this.hash=l(e%this.p),c.a.prime.generateProbablePrime(this.bits,(function(e,i){t.k=l(i.toString(10))}));while(l(this.p-1).lesser(this.k)||l.gcd(this.k,this.p-1).notEquals(1))c.a.prime.generateProbablePrime(this.bits,(function(e,i){t.k=l(i.toString(10))}));this.A=this.g.modPow(this.k,this.p);var i=l(this.k).modInv(this.p-1),n=l(this.p-1),s=l(this.x*this.A).mod(n),r=l(l(l(this.hash)-s).mod(n)+n);this.B=l(l(r).multiply(i)).mod(n)}else this.hash=0},check1:function(t,e,i,n){return t&&e&&i&&n?l(l(t).modPow(l(e),l(n))*l(e).modPow(l(i),l(n))).mod(l(n)):""},check2:function(t,e,i){return t&&e&&i?l(t).modPow(l(e),l(i)):""},check:function(){if(this.send){var t=l(this.send.hashCode());this.hash1=l(t%this.p);var e=this.check1(this.y,this.A,this.B,this.p).value,i=this.check2(this.g,this.hash1,this.p).value;return this.checked=e==i?e:0,this.check1(this.y,this.A,this.B,this.p).value==this.check2(this.g,this.hash1,this.p).value}this.hash1=0}}},d=u,v=(i("bd41"),i("2877")),p=Object(v["a"])(d,a,o,!1,null,"daf6dda6",null),f=p.exports,m={name:"App",components:{Main:f}},_=m,g=(i("5c0b"),Object(v["a"])(_,s,r,!1,null,null,null)),b=g.exports;n["a"].config.productionTip=!1,new n["a"]({render:function(t){return t(b)}}).$mount("#app")},"5c0b":function(t,e,i){"use strict";i("9c0c")},"632f":function(t,e,i){},"9c0c":function(t,e,i){},bd41:function(t,e,i){"use strict";i("632f")}});
//# sourceMappingURL=app.99ef28b2.js.map